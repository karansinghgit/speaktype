[NeMo W 2026-02-01 23:32:54 megatron_init:62] Megatron num_microbatches_calculator not found, using Apex version.
W0201 23:32:54.682000 36188 torch/distributed/elastic/multiprocessing/redirects.py:29] NOTE: Redirects are currently not supported in Windows or MacOs.
OneLogger: Setting error_handling_strategy to DISABLE_QUIETLY_AND_REPORT_METRIC_ERROR for rank (rank=0) with OneLogger disabled. To override: explicitly set error_handling_strategy parameter.
No exporters were provided. This means that no telemetry data will be collected.

============================================================
Converting: nvidia/parakeet-tdt-0.6b-v2
============================================================

Loading NeMo model: nvidia/parakeet-tdt-0.6b-v2
[NeMo I 2026-02-01 23:32:59 mixins:184] Tokenizer SentencePieceTokenizer initialized with 1024 tokens
[NeMo W 2026-02-01 23:32:59 modelPT:188] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    use_lhotse: true
    skip_missing_manifest_entries: true
    input_cfg: null
    tarred_audio_filepaths: null
    manifest_filepath: null
    sample_rate: 16000
    shuffle: true
    num_workers: 2
    pin_memory: true
    max_duration: 40.0
    min_duration: 0.1
    text_field: answer
    batch_duration: null
    use_bucketing: true
    bucket_duration_bins: null
    bucket_batch_size: null
    num_buckets: 30
    bucket_buffer_size: 20000
    shuffle_buffer_size: 10000
    
[NeMo W 2026-02-01 23:32:59 modelPT:195] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    use_lhotse: true
    manifest_filepath: null
    sample_rate: 16000
    batch_size: 16
    shuffle: false
    max_duration: 40.0
    min_duration: 0.1
    num_workers: 2
    pin_memory: true
    text_field: answer
    
[NeMo I 2026-02-01 23:32:59 features:306] PADDING: 0
[NeMo I 2026-02-01 23:33:01 rnnt_models:226] Using RNNT Loss : tdt
    Loss tdt_kwargs: {'fastemit_lambda': 0.0, 'clamp': -1.0, 'durations': [0, 1, 2, 3, 4], 'sigma': 0.02, 'omega': 0.1}
[NeMo I 2026-02-01 23:33:01 rnnt_models:226] Using RNNT Loss : tdt
    Loss tdt_kwargs: {'fastemit_lambda': 0.0, 'clamp': -1.0, 'durations': [0, 1, 2, 3, 4], 'sigma': 0.02, 'omega': 0.1}
[NeMo W 2026-02-01 23:33:01 label_looping_base:109] No conditional node support for Cuda.
    Cuda graphs with while loops are disabled, decoding speed will be slower
    Reason: CUDA is not available
[NeMo I 2026-02-01 23:33:01 rnnt_models:226] Using RNNT Loss : tdt
    Loss tdt_kwargs: {'fastemit_lambda': 0.0, 'clamp': -1.0, 'durations': [0, 1, 2, 3, 4], 'sigma': 0.02, 'omega': 0.1}
[NeMo W 2026-02-01 23:33:01 label_looping_base:109] No conditional node support for Cuda.
    Cuda graphs with while loops are disabled, decoding speed will be slower
    Reason: CUDA is not available
[NeMo I 2026-02-01 23:33:12 save_restore_connector:284] Model EncDecRNNTBPEModel was successfully restored from /Users/orm/.cache/huggingface/hub/models--nvidia--parakeet-tdt-0.6b-v2/snapshots/48b630d20b000e5ad3735e5378a2d9bde3f80826/parakeet-tdt-0.6b-v2.nemo.
W0201 23:33:14.599000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::nms
W0201 23:33:14.602000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::roi_align
W0201 23:33:14.602000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::roi_pool
W0201 23:33:15.035000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::nms
W0201 23:33:15.035000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::roi_align
W0201 23:33:15.035000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::roi_pool
W0201 23:33:16.148000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::nms
W0201 23:33:16.148000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::roi_align
W0201 23:33:16.149000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::roi_pool
W0201 23:33:16.152000 36188 torch/export/dynamic_shapes.py:919] Using None as a dynamic shape dimension is deprecated. Please use Dim.STATIC instead
W0201 23:33:16.365000 36188 torch/export/dynamic_shapes.py:919] Using None as a dynamic shape dimension is deprecated. Please use Dim.STATIC instead
Traceback (most recent call last):
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 121, in __call__
    exported_program = self._capture(model, args, kwargs, dynamic_shapes)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 219, in _capture
    return torch.export.export(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/__init__.py", line 311, in export
    raise e
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/__init__.py", line 277, in export
    return _export(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1271, in wrapper
    raise e
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1237, in wrapper
    ep = fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/exported_program.py", line 124, in wrapper
    return fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 2377, in _export
    ep = _export_for_training(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1271, in wrapper
    raise e
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1237, in wrapper
    ep = fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/exported_program.py", line 124, in wrapper
    return fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 2185, in _export_for_training
    export_artifact = export_func(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 2116, in _non_strict_export
    aten_export_artifact = _to_aten_func(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1904, in _export_to_aten_ir_make_fx
    gm, graph_signature = transform(_make_fx_helper)(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 2034, in _aot_export_non_strict
    gm, sig = aot_export(stack, wrapped_mod, args, kwargs=kwargs, **flags)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1816, in _make_fx_helper
    gm = make_fx(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2701, in wrapped
    return make_fx_tracer.trace(f, *args)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2626, in trace
    return self._trace_inner(f, *args)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2588, in _trace_inner
    t = dispatch_trace(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/_compile.py", line 54, in inner
    return disable_fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 1180, in _fn
    return fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 1460, in dispatch_trace
    graph = tracer.trace(root, concrete_args)  # type: ignore[arg-type]
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2177, in trace
    res = super().trace(root, concrete_args)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 879, in trace
    (self.create_arg(fn(*args)),),
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 1526, in wrapped
    out = f(*tensors)  # type:ignore[call-arg]
  File "<string>", line 1, in <lambda>
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1703, in wrapped_fn
    return tuple(flat_fn(*args))
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/utils.py", line 193, in flat_fn
    tree_out = fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/graph_capture_wrappers.py", line 1377, in functional_call
    out = mod(*args[params_len:], **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 853, in module_call_wrapper
    return self.call_module(mod, forward, args, kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2264, in call_module
    return Tracer.call_module(self, m, forward, args, kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 569, in call_module
    ret_val = forward(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 846, in forward
    return _orig_module_call(mod, *args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 2018, in forward
    tree_out = mod(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 853, in module_call_wrapper
    return self.call_module(mod, forward, args, kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2264, in call_module
    return Tracer.call_module(self, m, forward, args, kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 569, in call_module
    ret_val = forward(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 846, in forward
    return _orig_module_call(mod, *args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/nemo/core/classes/common.py", line 1198, in wrapped_call
    raise TypeError("All arguments must be passed by kwargs only for typed methods")
TypeError: All arguments must be passed by kwargs only for typed methods

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/orm/speaktype/convert_nemo_to_onnx.py", line 152, in <module>
    convert_to_onnx(model_name, output_dir)
  File "/Users/orm/speaktype/convert_nemo_to_onnx.py", line 101, in convert_to_onnx
    torch.onnx.export(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/onnx/__init__.py", line 296, in export
    return _compat.export_compat(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/onnx/_internal/exporter/_compat.py", line 154, in export_compat
    onnx_program = _core.export(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/onnx/_internal/exporter/_flags.py", line 27, in wrapper
    return func(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/onnx/_internal/exporter/_core.py", line 1409, in export
    raise _errors.TorchExportError(
torch.onnx._internal.exporter._errors.TorchExportError: Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'TypeError'>: All arguments must be passed by kwargs only for typed methods

(Refer to the full stack trace above for more information.)
‚úÖ Model loaded successfully
Attempting to export model to ONNX...
Using NeMo's export method...
NeMo export not available or failed: # Failed to convert 'dynamic_axes' to 'dynamic_shapes'. Please provide 'dynamic_shapes' directly. Refer to the documentation for 'torch.export.export' for more information on dynamic shapes.
Trying manual PyTorch export...
Attempting to export encoder only...
Exporting encoder to: ./models/nvidia_parakeet_tdt_0.6b_v2_encoder.onnx
[torch.onnx] Obtain model graph for `ConformerEncoder([...]` with `torch.export.export(..., strict=False)`...
[torch.onnx] Obtain model graph for `ConformerEncoder([...]` with `torch.export.export(..., strict=False)`... ‚ùå
[torch.onnx] Obtain model graph for `ConformerEncoder([...]` with `torch.export.export(..., strict=True)`...
[torch.onnx] Obtain model graph for `ConformerEncoder([...]` with `torch.export.export(..., strict=True)`... ‚ùå
Encoder export failed: Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'TypeError'>: missing a required argument: 'length'

(Refer to the full stack trace above for more information.)
Trying full model export...
Preparing model for ONNX export...
Trying input shape: torch.Size([1, 1000, 80])
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=False)`...
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=False)`... ‚ùå
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=True)`...
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=True)`... ‚ùå
Failed with shape torch.Size([1, 1000, 80]): Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'TypeError'>: All arguments must be passed by kwargs only for typed methods

(Refer to the full stack trace above for more information.)
Trying next input shape...
Trying input shape: torch.Size([1, 80, 1000])
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=False)`...
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=False)`... ‚ùå
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=True)`...
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=True)`... ‚ùå
Failed with shape torch.Size([1, 80, 1000]): Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'TypeError'>: All arguments must be passed by kwargs only for typed methods

(Refer to the full stack trace above for more information.)
‚ùå Manual export failed: Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'TypeError'>: All arguments must be passed by kwargs only for typed methods

(Refer to the full stack trace above for more information.)

‚ö†Ô∏è  Note: Parakeet models may require custom export logic.
You may need to:
1. Export encoder and decoder separately
2. Use NeMo's specific export methods
3. Check NeMo documentation for model-specific export

‚ùå Failed to convert nvidia/parakeet-tdt-0.6b-v2: Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'TypeError'>: All arguments must be passed by kwargs only for typed methods

(Refer to the full stack trace above for more information.)

Continuing with next model...


============================================================
Converting: nvidia/parakeet-tdt-0.6b-v3
============================================================

Loading NeMo model: nvidia/parakeet-tdt-0.6b-v3
[NeMo I 2026-02-01 23:33:24 mixins:184] Tokenizer SentencePieceTokenizer initialized with 8192 tokens
[NeMo W 2026-02-01 23:33:26 modelPT:188] If you intend to do training or fine-tuning, please call the ModelPT.setup_training_data() method and provide a valid configuration file to setup the train data loader.
    Train config : 
    use_lhotse: true
    skip_missing_manifest_entries: true
    input_cfg: null
    tarred_audio_filepaths: null
    manifest_filepath: null
    sample_rate: 16000
    shuffle: true
    num_workers: 2
    pin_memory: true
    max_duration: 10.0
    min_duration: 1.0
    text_field: answer
    batch_duration: null
    max_tps: null
    use_bucketing: true
    bucket_duration_bins: null
    bucket_batch_size: null
    num_buckets: 30
    bucket_buffer_size: 20000
    shuffle_buffer_size: 10000
    
[NeMo W 2026-02-01 23:33:26 modelPT:195] If you intend to do validation, please call the ModelPT.setup_validation_data() or ModelPT.setup_multiple_validation_data() method and provide a valid configuration file to setup the validation data loader(s). 
    Validation config : 
    use_lhotse: true
    manifest_filepath: null
    sample_rate: 16000
    batch_size: 16
    shuffle: false
    max_duration: 40.0
    min_duration: 0.1
    num_workers: 2
    pin_memory: true
    text_field: answer
    
[NeMo I 2026-02-01 23:33:26 features:306] PADDING: 0
[NeMo I 2026-02-01 23:33:30 rnnt_models:226] Using RNNT Loss : tdt
    Loss tdt_kwargs: {'fastemit_lambda': 0.0, 'clamp': -1.0, 'durations': [0, 1, 2, 3, 4], 'sigma': 0.02, 'omega': 0.1}
[NeMo I 2026-02-01 23:33:30 rnnt_models:226] Using RNNT Loss : tdt
    Loss tdt_kwargs: {'fastemit_lambda': 0.0, 'clamp': -1.0, 'durations': [0, 1, 2, 3, 4], 'sigma': 0.02, 'omega': 0.1}
[NeMo W 2026-02-01 23:33:30 label_looping_base:109] No conditional node support for Cuda.
    Cuda graphs with while loops are disabled, decoding speed will be slower
    Reason: CUDA is not available
[NeMo I 2026-02-01 23:33:30 rnnt_models:226] Using RNNT Loss : tdt
    Loss tdt_kwargs: {'fastemit_lambda': 0.0, 'clamp': -1.0, 'durations': [0, 1, 2, 3, 4], 'sigma': 0.02, 'omega': 0.1}
[NeMo W 2026-02-01 23:33:30 label_looping_base:109] No conditional node support for Cuda.
    Cuda graphs with while loops are disabled, decoding speed will be slower
    Reason: CUDA is not available
[NeMo I 2026-02-01 23:34:03 save_restore_connector:284] Model EncDecRNNTBPEModel was successfully restored from /Users/orm/.cache/huggingface/hub/models--nvidia--parakeet-tdt-0.6b-v3/snapshots/6d590f77001d318fb17a0b5bf7ee329a91b52598/parakeet-tdt-0.6b-v3.nemo.
W0201 23:34:35.600000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::nms
W0201 23:34:35.620000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::roi_align
W0201 23:34:35.620000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::roi_pool
W0201 23:34:35.883000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::nms
W0201 23:34:35.883000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::roi_align
W0201 23:34:35.883000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::roi_pool
W0201 23:34:36.837000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::nms
W0201 23:34:36.838000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::roi_align
W0201 23:34:36.838000 36188 torch/onnx/_internal/exporter/_registration.py:110] torchvision is not installed. Skipping torchvision::roi_pool
W0201 23:34:36.842000 36188 torch/export/dynamic_shapes.py:919] Using None as a dynamic shape dimension is deprecated. Please use Dim.STATIC instead
W0201 23:34:37.083000 36188 torch/export/dynamic_shapes.py:919] Using None as a dynamic shape dimension is deprecated. Please use Dim.STATIC instead
Traceback (most recent call last):
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 121, in __call__
    exported_program = self._capture(model, args, kwargs, dynamic_shapes)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 219, in _capture
    return torch.export.export(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/__init__.py", line 311, in export
    raise e
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/__init__.py", line 277, in export
    return _export(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1271, in wrapper
    raise e
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1237, in wrapper
    ep = fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/exported_program.py", line 124, in wrapper
    return fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 2377, in _export
    ep = _export_for_training(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1271, in wrapper
    raise e
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1237, in wrapper
    ep = fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/exported_program.py", line 124, in wrapper
    return fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 2185, in _export_for_training
    export_artifact = export_func(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 2116, in _non_strict_export
    aten_export_artifact = _to_aten_func(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1904, in _export_to_aten_ir_make_fx
    gm, graph_signature = transform(_make_fx_helper)(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 2034, in _aot_export_non_strict
    gm, sig = aot_export(stack, wrapped_mod, args, kwargs=kwargs, **flags)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1816, in _make_fx_helper
    gm = make_fx(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2701, in wrapped
    return make_fx_tracer.trace(f, *args)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2626, in trace
    return self._trace_inner(f, *args)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2588, in _trace_inner
    t = dispatch_trace(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/_compile.py", line 54, in inner
    return disable_fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 1180, in _fn
    return fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 1460, in dispatch_trace
    graph = tracer.trace(root, concrete_args)  # type: ignore[arg-type]
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2177, in trace
    res = super().trace(root, concrete_args)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 879, in trace
    (self.create_arg(fn(*args)),),
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 1526, in wrapped
    out = f(*tensors)  # type:ignore[call-arg]
  File "<string>", line 1, in <lambda>
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 1703, in wrapped_fn
    return tuple(flat_fn(*args))
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/utils.py", line 193, in flat_fn
    tree_out = fn(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/graph_capture_wrappers.py", line 1377, in functional_call
    out = mod(*args[params_len:], **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 853, in module_call_wrapper
    return self.call_module(mod, forward, args, kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2264, in call_module
    return Tracer.call_module(self, m, forward, args, kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 569, in call_module
    ret_val = forward(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 846, in forward
    return _orig_module_call(mod, *args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/export/_trace.py", line 2018, in forward
    tree_out = mod(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 853, in module_call_wrapper
    return self.call_module(mod, forward, args, kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/experimental/proxy_tensor.py", line 2264, in call_module
    return Tracer.call_module(self, m, forward, args, kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 569, in call_module
    ret_val = forward(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/fx/_symbolic_trace.py", line 846, in forward
    return _orig_module_call(mod, *args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/nemo/core/classes/common.py", line 1198, in wrapped_call
    raise TypeError("All arguments must be passed by kwargs only for typed methods")
TypeError: All arguments must be passed by kwargs only for typed methods

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/orm/speaktype/convert_nemo_to_onnx.py", line 152, in <module>
    convert_to_onnx(model_name, output_dir)
  File "/Users/orm/speaktype/convert_nemo_to_onnx.py", line 101, in convert_to_onnx
    torch.onnx.export(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/onnx/__init__.py", line 296, in export
    return _compat.export_compat(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/onnx/_internal/exporter/_compat.py", line 154, in export_compat
    onnx_program = _core.export(
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/onnx/_internal/exporter/_flags.py", line 27, in wrapper
    return func(*args, **kwargs)
  File "/Users/orm/.nemo_env/lib/python3.10/site-packages/torch/onnx/_internal/exporter/_core.py", line 1409, in export
    raise _errors.TorchExportError(
torch.onnx._internal.exporter._errors.TorchExportError: Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'TypeError'>: All arguments must be passed by kwargs only for typed methods

(Refer to the full stack trace above for more information.)
‚úÖ Model loaded successfully
Attempting to export model to ONNX...
Using NeMo's export method...
NeMo export not available or failed: # Failed to convert 'dynamic_axes' to 'dynamic_shapes'. Please provide 'dynamic_shapes' directly. Refer to the documentation for 'torch.export.export' for more information on dynamic shapes.
Trying manual PyTorch export...
Attempting to export encoder only...
Exporting encoder to: ./models/nvidia_parakeet_tdt_0.6b_v3_encoder.onnx
[torch.onnx] Obtain model graph for `ConformerEncoder([...]` with `torch.export.export(..., strict=False)`...
[torch.onnx] Obtain model graph for `ConformerEncoder([...]` with `torch.export.export(..., strict=False)`... ‚ùå
[torch.onnx] Obtain model graph for `ConformerEncoder([...]` with `torch.export.export(..., strict=True)`...
[torch.onnx] Obtain model graph for `ConformerEncoder([...]` with `torch.export.export(..., strict=True)`... ‚ùå
Encoder export failed: Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'TypeError'>: missing a required argument: 'length'

(Refer to the full stack trace above for more information.)
Trying full model export...
Preparing model for ONNX export...
Trying input shape: torch.Size([1, 1000, 80])
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=False)`...
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=False)`... ‚ùå
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=True)`...
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=True)`... ‚ùå
Failed with shape torch.Size([1, 1000, 80]): Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'TypeError'>: All arguments must be passed by kwargs only for typed methods

(Refer to the full stack trace above for more information.)
Trying next input shape...
Trying input shape: torch.Size([1, 80, 1000])
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=False)`...
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=False)`... ‚ùå
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=True)`...
[torch.onnx] Obtain model graph for `EncDecRNNTBPEModel([...]` with `torch.export.export(..., strict=True)`... ‚ùå
Failed with shape torch.Size([1, 80, 1000]): Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'TypeError'>: All arguments must be passed by kwargs only for typed methods

(Refer to the full stack trace above for more information.)
‚ùå Manual export failed: Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'TypeError'>: All arguments must be passed by kwargs only for typed methods

(Refer to the full stack trace above for more information.)

‚ö†Ô∏è  Note: Parakeet models may require custom export logic.
You may need to:
1. Export encoder and decoder separately
2. Use NeMo's specific export methods
3. Check NeMo documentation for model-specific export

‚ùå Failed to convert nvidia/parakeet-tdt-0.6b-v3: Failed to export the model with torch.export. [96mThis is step 1/3[0m of exporting the model to ONNX. Next steps:
- Modify the model code for `torch.export.export` to succeed. Refer to https://pytorch.org/docs/stable/generated/exportdb/index.html for more information.
- Debug `torch.export.export` and submit a PR to PyTorch.
- Create an issue in the PyTorch GitHub repository against the [96m*torch.export*[0m component and attach the full error stack as well as reproduction scripts.

## Exception summary

<class 'TypeError'>: All arguments must be passed by kwargs only for typed methods

(Refer to the full stack trace above for more information.)

Continuing with next model...

